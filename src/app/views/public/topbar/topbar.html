<!-- src/app/components/topbar/topbar.component.html -->
<header class="site-header" [class.scrolled]="isScrolled">
    <div class="container header-inner">

        <!-- Logo -->
        <a routerLink="/" class="header-logo" (click)="closeMenu()">
            <img src="/assets/images/RetentionForge-05.jpg" alt="Ariel photo" loading="lazy" class="header-logo__img" />
        </a>


        <!-- Desktop Navigation – Clean & Spacious -->
        <nav class="header-nav desktop-menu" aria-label="Main navigation">
            <ul class="nav-list">
                <li>
                    <a routerLink="/welcome" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
                        <i class="fa-solid fa-house"></i> Home
                    </a>
                </li>

                <li>
                    <a routerLink="/resources" routerLinkActive="active">
                        <i class="fa-regular fa-file-lines"></i> Resources
                    </a>
                </li>

                <li>
                    <a routerLink="/about" routerLinkActive="active">
                        <i class="fa-solid fa-circle-info"></i> About
                    </a>
                </li>

                <!-- Services – Mega-style on hover (no dropdown arrow clutter) -->
                <li class="nav-item-services">
                    <a routerLink="/services" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: false }"
                        class="nav-link-services" (mouseenter)="isShowDesktopMenu = true;"
                        (click)="isShowDesktopMenu = false;">

                        <i class="fa-solid fa-layer-group"></i>
                        Services
                        <i class="fa-solid fa-chevron-down"></i>
                    </a>

                    <!-- Mega Dropdown -->
                    <div class="services-megamenu" (mouseleave)="isShowDesktopMenu = false;" *ngIf="isShowDesktopMenu">
                        <div class="megamenu-grid">
                            <div class="megamenu-column">
                                <h4><i class="fa-solid fa-chart-line"></i> Core Retention Services</h4>
                                <ul>
                                    <li><a routerLink="/services/churn-analysis" (click)="closeMenu()"
                                            routerLinkActive="active-submenu"
                                            [routerLinkActiveOptions]="{ exact: false }">Churn Analysis &
                                            Retention Studies</a></li>
                                    <li><a routerLink="/services/customer-success-department-design-build"
                                            routerLinkActive="active-submenu" (click)="closeMenu()">CS Department
                                            Design & Build</a></li>
                                    <li><a routerLink="/services/revenue-retention-strategy-optimization"
                                            routerLinkActive="active-submenu" (click)="closeMenu()">Revenue
                                            Retention Strategy</a></li>
                                    <li><a routerLink="/services/customer-health-scoring-system-development"
                                            routerLinkActive="active-submenu" (click)="closeMenu()">Customer Health
                                            Scoring</a></li>
                                </ul>
                            </div>

                            <div class="megamenu-column">
                                <h4><i class="fa-solid fa-person-arrow-up-from-line"></i> Growth & Expansion</h4>

                                <ul>
                                    <li><a routerLink="/services/account-management-expansion-strategy"
                                            routerLinkActive="active-submenu" (click)="closeMenu()">Account
                                            Management & Expansion</a></li>
                                    <li><a routerLink="/services/onboarding-implementation-optimization"
                                            routerLinkActive="active-submenu" (click)="closeMenu()">Onboarding
                                            Optimization</a></li>
                                    <li><a routerLink="/services/professional-services-revenue-optimization"
                                            routerLinkActive="active-submenu" (click)="closeMenu()">Professional
                                            Services Revenue</a></li>
                                </ul>
                            </div>

                            <div class="megamenu-column">
                                <h4><i class="fa-solid fa-users-gear"></i> Leadership & Systems</h4>
                                <ul>
                                    <li><a routerLink="/services/organizational-design-for-post-sale-teams"
                                            routerLinkActive="active-submenu" (click)="closeMenu()">Post-Sale Org
                                            Design</a></li>
                                    <li><a routerLinkActive="active-submenu"
                                            routerLink="/services/KPI-framework-metrics-design"
                                            (click)="closeMenu()">KPI
                                            & Metrics
                                            Framework</a></li>
                                    <li><a routerLinkActive="active-submenu"
                                            routerLink="/services/executive-coaching-for-customer-success-leaders"
                                            (click)="closeMenu()">Executive CS
                                            Coaching</a></li>
                                </ul>
                            </div>
                        </div>

                        <!-- Mini CTA inside megamenu -->
                        <div class="megamenu-cta">
                            <p><i class="fa-solid fa-headset"></i> Not sure where to start?</p>
                            <button class="btn btn-primary btn-small" (click)="isShowDesktopMenu = false;"
                                routerLink="/contact">Book a Free
                                Consultation</button>
                        </div>
                    </div>
                </li>

                <li>
                    <a routerLink="/contact" routerLinkActive="active">
                        <i class="fa-solid fa-phone"></i> Contact
                    </a>
                </li>

            </ul>
        </nav>


        <!-- CTA Button – Always Visible on Desktop -->
        <div class="header-cta">
            <a routerLink="/contact" class="btn btn-primary">
                <i class="fa-solid fa-calendar-check"></i>
                Book Consultation
            </a>
        </div>

        <!-- Mobile Menu Toggle -->
        <button class="mobile-toggle" (click)="toggleMobileMenu()" [attr.aria-expanded]="isMobileMenuOpen">
            <span></span><span></span><span></span>
        </button>

    </div>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay" [class.open]="isMobileMenuOpen" (click)="closeMenu()"></div>
    <nav class="mobile-menu" [class.open]="isMobileMenuOpen">
        <div class="mobile-menu-header">
            <a routerLink="/welcome" class="mobile-logo" (click)="closeMenu()">RetentionForge</a>
            <!-- Close icon (×) -->
            <button class="mobile-close" (click)="closeMenu()" aria-label="Close menu">
                <i class="fa-solid fa-xmark"></i>
            </button>
        </div>

        <ul class="mobile-nav-list">
            <li>
                <a routerLink="/welcome" routerLinkActive="active-submenu" [routerLinkActiveOptions]="{exact: true}"
                    (click)="closeMenu()">Home</a>
            </li>
            <li>
                <a routerLink="/resources" routerLinkActive="active">
                     Resources
                </a>
            </li>
            <li>
                <a routerLink="/about" routerLinkActive="active-submenu" (click)="closeMenu()">About</a>
            </li>

            <!-- Services Parent + Dropdown -->
            <li>
                <a href="javascript:void(0)" class="services-toggle" (click)="toggleMobileServices()"
                    [class.active]="isServicesPageActive()">
                    Services
                    <i class="fa-solid fa-chevron-down" [class.rotate-180]="mobileServicesOpen"></i>
                </a>

                <ul class="mobile-services-list" [class.open]="mobileServicesOpen">
                    <li><a routerLink="/services/churn-analysis" routerLinkActive="active-submenu"
                            (click)="closeMenu()">Churn
                            Analysis</a></li>
                    <li><a routerLink="/services/customer-success-department-design-build"
                            routerLinkActive="active-submenu" (click)="closeMenu()">CS
                            Department Build</a></li>
                    <li><a routerLink="/services/revenue-retention-strategy-optimization"
                            routerLinkActive="active-submenu" (click)="closeMenu()">Revenue Retention</a></li>
                    <li><a routerLink="/services/customer-health-scoring-system-development"
                            routerLinkActive="active-submenu" (click)="closeMenu()">Customer Health Scoring</a></li>
                    <li><a routerLink="/services/account-management-expansion-strategy"
                            routerLinkActive="active-submenu" (click)="closeMenu()">Account Expansion</a></li>
                    <li><a routerLink="/services/onboarding-implementation-optimization"
                            routerLinkActive="active-submenu" (click)="closeMenu()">Onboarding
                            Optimization</a></li>
                    <li><a routerLink="/services/professional-services-revenue-optimization"
                            routerLinkActive="active-submenu" (click)="closeMenu()">Professional Services</a></li>
                    <li><a routerLink="/services/organizational-design-for-post-sale-teams"
                            routerLinkActive="active-submenu" (click)="closeMenu()">Org
                            Design</a></li>
                    <li><a routerLink="/services/KPI-framework-metrics-design" routerLinkActive="active-submenu"
                            (click)="closeMenu()">KPI
                            Framework</a></li>
                    <li><a routerLink="/services/executive-coaching-for-customer-success-leaders"
                            routerLinkActive="active-submenu" (click)="closeMenu()">Executive
                            Coaching</a></li>
                </ul>
            </li>

            <li>
                <a routerLink="/contact" routerLinkActive="active-submenu" (click)="closeMenu()">Contact</a>
            </li>

            <!-- CTA -->
            <li class="mobile-cta" (click)="closeMenu()">
                <a routerLink="/contact" class="btn btn-primary d-flex justify-content-center text-white">
                    <i class="fa-solid fa-calendar-check"></i>
                    <span>
                        Schedule Consultation
                    </span>
                </a>
            </li>
        </ul>
    </nav>
</header>